---
title: "Taller 1"
author: "Andres Felipe Beltran Rodriguez"
date: "10/23/2021"
output:
    pdf_document
extra_dependencies: ["supertabular", "booktabs"]
fig_caption: yes
classoption:
- twocolumn
highlight: tango

---
<!-- \usepackage{supertabular,booktabs} -->

1. Con la variable gastos semanales de los empleados en una empresa construya:

a. una distribución de frecuencias, de frecuencias relativas, acumuladas, y relativas acumuladas.

Para resolver este punto debemos ingresar los datos a R:

```{r}
library(readxl)
tarea1 <- read_excel("./tarea1.xlsx")

gastos <- tarea1$gastos
```

Para definir la cantidad de intervalos en los cuales separar los datos, podemos utilizar la ecuacion de sturges [(Sturges 1926)](https://www.tandfonline.com/doi/abs/10.1080/01621459.1926.10502161)

\begin{align}
k = 1 + 3.332 \cdot log(n)
\end{align}

* n = tamaño de muestra, número de observaciones
* k = número de intervalos

podemos revisar el tamaño de muestra con la función `length()` de R:

```{r}
length(gastos)
```
Para esta muestra de 90 individuos:

\begin{align}
k = 1 + 3.332 \cdot log(90)
\end{align}

```{r}
k <- 1 + (3.322 * log10(90))
k
round(k,0)
```

\begin{align}
7 \approx 7.491994 = 1 + 3.332 \cdot log(90)
\end{align}

Para este conjunto de datos podemos utilizar 7 intervalos. Para saber el tamaño del intervalo, podemos dividir el rango en el número de intervalos:

\begin{align}
longitud \; del \; intervalo = \frac{max(gastos)-min(gastos)}{7}
\end{align}

```{r}
LongInt <- (max(gastos)-min(gastos))/7
LongInt
```

La longitud del intervalo es $13620.12 \approx 13620$.

```{r}
LongInt <- round(LongInt,0) 
LongInt
```
Podemos entonces construir la tabla de valores minimos y máximos para este intervalo:

Primero calculamos los límites inferiores de los 16 intervalos, Teniendo encuenta que ya tenemos el primero, `min(gastos)`, tenemos que calcular los 15 restantes. 

```{r}

mins <- seq(min(gastos), 
            min(gastos)+((LongInt))*6,
            by = LongInt)

```


Para calcular los límites superiores, basta con sumar la longitud del intervalo - 1, ya que uno de los valores del intervalo ya está (el límite inferior): 

```{r}
maxs <- mins + LongInt-1

TDF <- data.frame(
  min = mins,
  max = maxs
)
TDF
```

Ahora podemos iterar a lo largo de las filas de la tabla de frecuencias `TDF` buscando cuantos elementos de `gastos` estan dentro de cada intervalo definido por cada fila.
 
```{r}
for(i in 1: nrow(TDF)){
  
  TDF$fi[i] <- length(
    which(
TDF$min[i] <= gastos & gastos <= TDF$max[i]
    )
  )
  
}
TDF
```

Una vez tenemos la frecuencia absoluta, podemos calcular la frecuencia relativa dividiendo por el numero de observaciones:

```{r}
TDF$fr <- round(TDF$fi/length(gastos),2)
TDF
```

Una vez tenemos las frecuencias absolutas y relativas, podemos calcular las acumuladas de la siguiente manera:

* Primero para la frecuencia absoluta acumulada$(F_i)$:

```{r}
for(i in 1:nrow(TDF)){
  
  TDF$Fi[i] <- sum(TDF$fi[1:i]) 
  
}

```

* También para la frecuencia relativa acumulada$(F_r)$:

```{r, echo =F}
options(knitr.table.format = "latex")
```


```{r}
for(i in 1:nrow(TDF)){
  
  TDF$Fr[i] <- sum(TDF$fr[1:i]) 
  
}

```


Una vez hemos calculado todas las frecuencias, podemos imprimir la tabla final:

```{r, echo  = F}
TDF2 <- TDF
colnames(TDF2) <- c('min.',
                   'max.',
                   'f~i~',
                   'f~r~',
                   'F~i~',
                   'F~r~'
                   
                   )
```
\onecolumn
```{r}
knitr::kable(TDF2,"simple") 
```

\twocolumn

Para observar los resultados de la tabla de frecuencias, podemos hacer un histograma del porcentaje de frecuencia relativa en funcion de los intervalos:


```{r}
library(ggplot2)

intervalos <- sort(factor(paste(TDF$min,'-',TDF$max),
                     levels = paste(TDF$min,'-',TDF$max),) )
ggplot(TDF,
aes(x = reorder(intervalos,intervalos, function(x)-length(x)),
y = fr*100,
fill=intervalos,
label = round(fr*100,2)
)
) +
geom_bar(stat="identity") +
xlab("intervalo") +
ylab('% frecuencia relativa')+
geom_label(aes(fill = intervalos),
colour = "white",
fontface = "italic") +
 theme(axis.text.x = element_blank())
```
# Medidas descriptivas de localización


# Referencias

* Sturges, H. A. (1926). The choice of a class interval.  Journal of the american statistical association,  21(153), 65-66.
